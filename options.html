<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Summarizer - Settings</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <div class="form-actions">
      <button type="submit" form="options-form" class="save-button">
        <span class="button-text">Save Settings</span>
      </button>
      <button type="button" id="test-connection" class="test-button">
        Test Connection
      </button>
    </div>

    <header>
      <h1>AI Summarizer Settings</h1>
      <p class="subtitle">Configure your API settings to start summarizing web content</p>
    </header>

    <main>
      <form id="options-form" class="settings-form">
        <div class="form-section">
          <h2>API Configuration</h2>
          
          <div class="form-group">
            <label for="api-url" class="required">OpenAI-Compatible API URL</label>
            <input 
              type="url" 
              id="api-url" 
              name="api-url" 
              placeholder="https://api.openai.com/v1/chat/completions"
              required
              autocomplete="off"
            >
            <small class="help-text">Enter OpenAI-Compatible API URL (Example: https://api.openai.com/v1/chat/completions)</small>
          </div>

          <div class="form-group">
            <label for="api-key" class="required">API Key</label>
            <div class="password-input-wrapper">
              <input 
                type="password" 
                id="api-key" 
                name="api-key" 
                placeholder="sk-..."
                required
                autocomplete="new-password"
              >
              <button type="button" id="toggle-password" class="toggle-password" title="Show/Hide API Key">
                Show
              </button>
            </div>
            <small class="help-text">Your API key will be stored securely in your browser</small>
          </div>

          <div class="form-group">
            <label for="model" class="required">Model Name</label>
            <input 
              type="text" 
              id="model" 
              name="model" 
              placeholder="gpt-4o-mini"
              required
              autocomplete="off"
            >
            <small class="help-text">Specify the model to use (Example: gpt-4o-mini). This field is required.</small>
          </div>
        </div>

        <div class="form-section">
          <h2>Feature Settings</h2>

          <div class="form-group form-group-toggle">
            <label for="enable-streaming">Enable Streaming</label>
            <div class="toggle-switch">
              <input type="checkbox" id="enable-streaming" name="enable-streaming">
              <label class="slider" for="enable-streaming"></label>
            </div>
            <small class="help-text">Receive responses in real-time as generated. May not be supported by all API/Model providers.</small>
          </div>

          <div class="form-group form-group-toggle">
            <label for="include-timestamps">Include Timestamps (YouTube)</label>
            <div class="toggle-switch">
              <input type="checkbox" id="include-timestamps" name="include-timestamps">
              <label class="slider" for="include-timestamps"></label>
            </div>
            <small class="help-text">Note: Including timestamps increases the tokens sent to the API endpoint and may result in higher API costs.</small>
          </div>
        </div>

        <div class="form-section">
          <h2>Subtitle Settings</h2>

          <div class="form-group">
            <label for="subtitle-priority">Subtitle Type</label>
            <select id="subtitle-priority" name="subtitle-priority">
              <option value="auto" selected>Automatic (ASR)</option>
              <option value="manual">Manual (human-provided)</option>
            </select>
            <small class="help-text">Choose to prioritize Automatic Speech Recognition *recommend* or manual subtitles. Automatic fall back if not available.</small>
          </div>

          <div class="form-group">
            <label for="preferred-language">Preferred Language</label>
            <input
              type="text"
              id="preferred-language"
              name="preferred-language"
              placeholder="en"
              autocomplete="off"
            >
            <small class="help-text">Enter a language code (e.g., en, es, fr). Only one language code at a time. Defaults to English (en).</small>
          </div>
        </div>

        <div class="form-section">
          <h2>Reddit Settings</h2>
          
          <div class="form-group">
            <label for="reddit-max-comments">Max Comments</label>
            <input type="number" id="reddit-max-comments" name="reddit-max-comments" min="1" max="100" placeholder="20">
            <small class="help-text">Maximum number of top-level threads to include (1-100).</small>
          </div>

          <div class="form-group">
            <label for="reddit-depth">Include Reply Depth</label>
            <input type="number" id="reddit-depth" name="reddit-depth" min="0" max="10" placeholder="1">
            <small class="help-text">How deep to go into comment replies (0 = top level only).</small>
          </div>

          <div class="form-group">
            <label for="reddit-sort">Sort Comments By</label>
            <select id="reddit-sort" name="reddit-sort">
              <option value="current" selected>Current (Visible Page)</option>
              <option value="best">Best</option>
              <option value="top">Top</option>
              <option value="new">New</option>
            </select>
            <small class="help-text">Choose which comments to summarize. 'Current' uses the page as-is. Others fetch sorted content in the background.</small>
          </div>
        </div>

        <div class="form-section">
          <h2>Summarization Settings</h2>
          
          <div class="form-group">
            <div class="label-group">
              <label for="system-prompt">System Prompt</label>
              <button type="button" id="default-prompt-btn" class="text-button">Use Default</button>
            </div>
            <textarea 
              id="system-prompt" 
              name="system-prompt" 
              rows="6" 
              placeholder="You are a helpful assistant that summarizes content clearly and concisely. Focus on the main points and key takeaways."
            ></textarea>
            <small class="help-text">
              Customize how the AI should summarize content. Leave blank for default behavior.
              <br>
              <strong>Byte limit:</strong> <span id="prompt-counter">0</span>/8000
            </small>
          </div>

          <div class="form-group">
            <label for="default-font-size">Default Font Size (px)</label>
            <input type="number" id="default-font-size" name="default-font-size" min="8" max="24" placeholder="14">
            <small class="help-text">Set the initial font size for the summary window (from 8 to 24).</small>
          </div>

        </div>
      </form>

      <div class="info-section">
        <h3>How to Use</h3>
        <ol>
          <li>Configure your API settings above</li>
          <li>Navigate to any webpage or YouTube video</li>
          <li>Click the extension icon in your browser toolbar</li>
          <li>Wait for the AI to analyze and summarize the content</li>
          <li>View the summary in the floating window</li>
        </ol>
        
        <div class="supported-sites">
          <h4>Supported Content Types</h4>
          <ul>
            <li>Regular web pages (extracts visible text)</li>
            <li>YouTube videos (uses auto-generated transcripts)</li>
            <li>News articles and blog posts</li>
            <li>Documentation and guides</li>
          </ul>
        </div>
      </div>
    </main>
  </div>

  <script src="options.js"></script>
</body>
</html>
